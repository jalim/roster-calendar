# Roster Calendar Service
PORT=3000

# Persist ingested rosters to disk (survives restarts)
ROSTER_PERSIST_ENABLED=true
ROSTER_PERSIST_PATH=./data/roster-store.json

# CalDAV Authentication - Password credentials storage
# Stores hashed passwords for staff number authentication
ROSTER_CREDENTIALS_PATH=./data/credentials.json

# Enable IMAP polling for roster attachments
ROSTER_EMAIL_POLLING_ENABLED=true

# IMAP (example: port 143 with STARTTLS)
ROSTER_EMAIL_IMAP_HOST=imap.example.com
ROSTER_EMAIL_IMAP_PORT=143
ROSTER_EMAIL_IMAP_SECURE=false
ROSTER_EMAIL_IMAP_STARTTLS=true

# Mailbox credentials
ROSTER_EMAIL_IMAP_USER=roster@example.com
ROSTER_EMAIL_IMAP_PASS=CHANGEME_APP_PASSWORD

# Mailboxes/folders
ROSTER_EMAIL_IMAP_MAILBOX=INBOX
ROSTER_EMAIL_PROCESSED_MAILBOX=Processed

# Polling interval (ms)
ROSTER_EMAIL_POLL_INTERVAL_MS=60000

# Which messages to scan:
# - unseen (default): only UNSEEN messages
# - all: process all messages (requires ROSTER_EMAIL_PROCESSED_MAILBOX)
ROSTER_EMAIL_IMAP_SEARCH=unseen

# Optional safety filters
# Comma-separated list of allowed sender email addresses
# ROSTER_EMAIL_FROM_ALLOWLIST=you@example.com,ops@example.com

# Only process emails whose subject contains this substring (case-insensitive)
# ROSTER_EMAIL_SUBJECT_CONTAINS=roster

# --- Outbound roster change notifications (SMTP) ---

# Enable/disable notification emails when a new roster is ingested via IMAP
ROSTER_NOTIFY_ENABLED=false

# If true, logs instead of sending
ROSTER_NOTIFY_DRY_RUN=true

# StaffNo -> email mapping DB
ROSTER_PILOT_EMAIL_DB_PATH=./data/pilot-email-map.json

# SMTP config (required when ROSTER_NOTIFY_ENABLED=true and ROSTER_NOTIFY_DRY_RUN=false)
ROSTER_SMTP_HOST=smtp.example.com
ROSTER_SMTP_PORT=587
ROSTER_SMTP_SECURE=false
ROSTER_SMTP_USER=roster@example.com
ROSTER_SMTP_PASS=CHANGEME_SMTP_PASSWORD

# From address (defaults to ROSTER_SMTP_USER if not set)
ROSTER_EMAIL_FROM=roster@example.com
